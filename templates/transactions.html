{% extends "base.html" %}

{% block container_class %}no-center{% endblock %}
{% block title %}Transactions - Path2Save{% endblock %}
{% block head %}
<style>
    .hidden {
        display: none;
    }
</style>
{% endblock %}
{% block content %}
<div class="no-center">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <h1>Your Transactions</h1>

    <!-- add form -->
    <div class="addTable" id="addForm">
        <form method="POST" action="/transactions">
            <label>Type:</label>
            <select name="type" required>
                <option value="">--Select--</option>
                <option value="income">Income</option>
                <option value="expense">Expense</option>
            </select><br><br>

            <label>Category:</label>
            <select name="category" required>
                <option value="">--Select--</option>
                <optgroup label="Income">
                    <option value="Salary">Salary</option>
                    <option value="Bonus">Bonus</option>
                    <option value="Investment Income">Investment Income</option>
                    <option value="Gift">Gift</option>
                    <option value="Other Income">Other Income</option>
                </optgroup>
                <optgroup label="Expenses">
                    <option value="Food & Drinks">Food & Drinks</option>
                    <option value="Groceries">Groceries</option>
                    <option value="Transportation">Transportation</option>
                    <option value="Utilities">Utilities</option>
                    <option value="Rent / Mortgage">Rent / Mortgage</option>
                    <option value="Subscriptions">Subscriptions</option>
                    <option value="Shopping">Shopping</option>
                    <option value="Education">Education</option>
                    <option value="Health & Fitness">Health & Fitness</option>
                    <option value="Entertainment">Entertainment</option>
                    <option value="Travel">Travel</option>
                    <option value="Insurance">Insurance</option>
                    <option value="Debt Payments">Debt Payments</option>
                    <option value="Donations">Donations</option>
                    <option value="Pets">Pets</option>
                    <option value="Miscellaneous">Miscellaneous</option>
                    <option value="Other Expenses">Other Expenses</option>
                </optgroup>
            </select><br><br>


            <label>Amount:</label>
            <input type="number" name="amount" step="0.01" required><br><br>

            <label>Date:</label>
            <input type="date" name="date" required><br><br>

            <label>Notes:</label>
            <input type="text" name="notes"><br><br>

            <label>Recurring:</label>
            <select name="recurring">
                <option value="none">None</option>
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
                <option value="biweekly">Biweekly</option>
                <option value="monthly">Monthly</option>
                <option value="yearly">Yearly</option>

            </select><br><br>

            <button type="submit">Add</button>
        </form>
    </div>

    <!-- view table -->
    <div class="viewTable">
        {% if transactions %}
        <table>
            <tr>
                <th>Type</th>
                <th>Category</th>
                <th>Amount</th>
                <th>Date</th>
                <th>Notes</th>
                <th>Recurring</th>
            </tr>
            {% for t in transactions %}
            <tr>
                <td>{{ t['type'].capitalize() }}</td>
                <td>{{ t['category'] }}</td>
                <td>${{ t['amount'] }}</td>
                <td>{{ t['date'] }}</td>
                <td>{{ t['notes'] }}</td>
                <td>{{ t['recurring'].capitalize() }}</td>
                <td>
                    <form action="{{ url_for('delete_transaction', transaction_id=t['id']) }}" method="POST"
                        style="display:inline;">
                        <button type="submit"
                            onclick="return confirm('Are you sure you want to delete this transaction?');"
                            style="background:none; border:none; cursor:pointer; color:#dc3545;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </table>
        {% else %}
        <p>No transactions yet!</p>
        {% endif %}
    </div>

    <script>
        function toggleForm() {
            const form = document.getElementById("addForm");
            form.classList.toggle("hidden");
        }
    </script>

</div>
{% endblock %}