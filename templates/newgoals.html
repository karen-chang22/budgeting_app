{% extends "base.html" %}
{% block content %}
<div class="no-center" style="margin-top:0; padding-top:0; margin-left: 10px">
    <h1>Goals</h1>
</div>
<!-- adding a goal -->
<div class="goal-form" style="border: 1px solid #ccc; padding-left: 30px; padding-bottom: 15px;margin-bottom: 40px; border-radius: 10px;">
  <!-- some inline styling above -->
  <h2>Add New Goal</h2>
  <form method="POST" action="{{ url_for('goals') }}">
    <label for="title">Title:</label><br>
    <input type="text" name="title" required><br><br>

    <label for="target_amount">Target Amount ($):</label><br>
    <input type="number" name="target_amount" step="0.01" required><br><br>

    <label for="target_date">Target Date:</label><br>
    <input type="date" name="target_date" required><br><br>

    <label for="notes">Notes (optional):</label><br>
    <textarea name="notes" rows="3"></textarea><br><br>

    <label for="created_date">Created On:</label><br>
    <input type="text" value="{{ now }}" readonly><br><br>

    <button type="submit" style="background-color: #4caf50; color: white; padding: 8px 16px; border: none; border-radius: 5px;">Add Goal</button>
  </form>
</div>

<!-- displaying pre-existing goals -->
<h2 class="goal-section-title">Your Goals</h2>

<div class="goal-container">
  {% for g in goals %}
  <div class="goal-card">
    <h3>{{ g['title'] }}</h3>
    <p><strong>ğŸ¯ Target:</strong> ${{ g['target_amount'] }}</p>
    <p><strong>ğŸ“… Target Date:</strong> {{ g['target_date'] }}</p>
    <p><strong>ğŸ› ï¸ Created:</strong> {{ g['created_date'] }}</p>
    <p><strong>ğŸ’¾ Saved:</strong> ${{ g['current_amount'] | round(2) }}</p>
    <p><strong>ğŸ’¸ Left to Save:</strong> ${{ g['left_to_save'] | round(2) }}</p>

  <!-- add amount form -->
  <form action="{{ url_for('update_goal', goal_id=g['id']) }}" method="POST" style="margin-top: 10px;">
    <input type="number" name="amount" placeholder="Add $" step="0.01" required style="width: 100px;">
    <button type="submit">Add</button>
  </form>
  <!-- delete button -->
 <form action="{{ url_for('delete_goal', goal_id=g['id']) }}" method="POST" style="display:inline;">
  <button type="submit"
          onclick="return confirm('Are you sure you want to delete this goal?');"
          style="background:none; border:none; cursor:pointer; color:#dc3545;">
    <i class="fas fa-trash"> Delete Goal</i>
  </button>
</form>
  <!-- progress bar -->
  <div style="background-color: #e0e0e0; height: 20px; border-radius: 10px; overflow: hidden; margin-top: 10px;">
    <div style="background-color: #4caf50; width: {{ g['progress'] }}%; height: 100%; text-align: center; color: white; font-size: 12px;">
      {{ g['progress'] }}%
    </div>
  </div>
</div>
{% endfor %}

{% endblock %}